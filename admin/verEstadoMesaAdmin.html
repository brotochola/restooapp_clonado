<div class="fondo-modal" id="verEstadoMesaAdmin" style="display:none">
    <div class="contenedor-modal">
        <div class="cuerpo-modal">
            <div class="container-cuerpo">
                <div class="container">
                    <div class="row"> <span id="idMesa" class="idMesa">#5</span></div>
                    <div class="row">
                        <div class="col-6 pp-n-left">
                            <div class="info"><img src="../media/Img/usuario-seleccionado.png"> <span id="nombreCliente">fulanito de tal</span></div>
                        </div>
                        <div class="col-6 pp-n-right">
                            <div class="info"><img src="../media/Img/visitas.png"> Visitas: <strong id="cantVisitas">#8</strong> </div>
                        </div>
                        <div class="col-12 pp-n-right">
                            <div class="info"><img src="../media/Img/calendario-seleccionado.png"><span id="ultimaVisita"> Ultima Visita: 25 - JULIO - 2018</span></div>
                        </div>
                        <div class="col-12 pp-n-right">
                            <div class="info"><img src="../media/Img/usuarios-gris.png"> Total De Comenzales: <strong id="cantComensales">#8</strong> </div>
                        </div>
                        <div class="col-6 pp-n-left">
                            <div class="info"><img src="../media/Img/mozo.png"><span id="mozoAsignado"> Mozo Asignado</span></div>
                        </div>
                        <div class="col-6 pp-n-right">
                            <div class="info"><img src="../media/Img/bolsa-dinero.png"> Total: <strong id="total">$400</strong> </div>
                        </div>
                    </div>
                    <div class="row encabezado-lista-pedidos">
                        <div class="col-2 paddingr">
                            <img src="../media/Img/pedido.png" class="pedidosIMG">
                        </div>
                        <div class="col-10 pp-none text-lista">LISTA DE PEDIDOS </div>
                    </div>
                    <div class="row contenedor-lista-pedidos">
                        <ul id="listadoDePedidosMesa">
                            <li>
                                <div class="container">
                                    <div class="row">
                                        <div class="col-2 text-center contenedor-icono-listado">
                                            <h5>#1</h5></div>
                                        <div class="col-4 hora-listado">23:14 hr.</div>
                                        <div class="col-4 estado-pedido"><span class="entregado">ENTREGADO</span></div>
                                        <div class="col-2 contenedor-boton-borrar"><img class="boton-borrar" src="../media/Img/inf.png"></div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="text-center">
                <div class="container botonesVerEstadoMesaAdmin">
                    <div class="row">
                        <div class="col-1"></div>
                        <div class="col-10">
                            <button class="boton-modal cancelar" onclick="cerrarMesa()">Cerrar Mesa</button>
                        </div>
                        <div class="col-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-1"></div>
                        <div class="col-10">
                            <button class="boton-modal" id="botonEstadisticas">Estadisticas</button>
                        </div>
                        <div class="col-1"></div>
                    </div>
                    <div class="row">
                        <div class="col-1"></div>
                        <div class="col-10">
                            <button class="boton-modal " onclick="$('#verEstadoMesaAdmin').fadeOut()">OK</button>
                        </div>
                        <div class="col-1"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
var estadosPedidos = [null, "Pendiente", "En Preparación", "Listo", "Servido", "Cancelado"]

 var estadosMesas=["Libre", "Ocupada sin Pedido", "Esperando Pedido", "Pedido Listo", "Comiendo", "Esperando Cuenta", "Pagada"];

var idMesa = -1;
var mesa = {};

function cerrarMesa() {
    mostrarModalConfirmacion("Seguro que quiere cerrar la facturación de este mesa?", "Si", "No", function() {
        $.ajax({
            url:"../../server/admin/mesas/cerrar/id",
            headers:{
                token: localStorage[usuarioLogueado_ls]
            },
            data:{
                "id":idMesa
            },
            success:function(e){
                //aca habria q evaluar segun lo q viene del server
                //una vez cerrada la mesa
                console.log(e)                
                ocultarModalConfirmacion();
                $("#verEstadoMesaAdmin").fadeOut();
                
            }
        })
    }//cb si
    )//mostrar moal confirmacion
}//cerrar mesa

function mostrarEstadoMesaAdmin(id) {
    idMesa = id;
    $("#botonEstadisticas").off().click(function() {
        window.location.href = "estadisticas.html?mesaId=" + id
    })

    $.ajax({
        url: "../../server/admin/mesas/id/",
        headers: {
            token: localStorage[usuarioLogueado_ls]
        },
        data: {
            id: id
        },
        success: function(e) {

            try { mesa = JSON.parse(e) } catch (e) { mesa = e }

            $("#listadoDePedidosMesa").html("")
            //arma pedidos
            for (var i = 0; i < mesa.pedidos.length; i++) {
                pe = mesa.pedidos[i]
                $("#listadoDePedidosMesa").append(armarPedido(pe))
            }

            //datos
            $("#idMesa").html("#" + id)
            $("#nombreCliente").html(mesa.cliente.nombre)
            $("#cantVisitas").html(mesa.cliente.cantVisitas)
            if (mesa.cliente.ultimaVisita == "null") $("#ultimaVisita").html("Hoy")
            else $("#ultimaVisita").html(mesa.cliete.ultimaVisita)

            $("#cantComensales").html(mesa.cliente.cantComensales)
            $("#mozoAsignado").html(mesa.nombreMozo)
            $("#total").html("$" + mesa.total)




        }
    })


    $("#verEstadoMesaAdmin").fadeIn();
}




function armarPedido(pedido) {
    console.log(pedido)
    html = ' <li>'
    html += '<div class="container">'
    html += '<div class="row" onclick="verPedido(' + pedido.id + ')">'
    html += '<div class="col-2 text-center contenedor-icono-listado"><h5>#' + pedido.id + '</h5></div>'
    html += '<div class="col-4 hora-listado horaEnListaDePedidos">' + pedido.horaPedido + ' hr.</div>'
    html += '<div class="col-4 estado-pedido"><span style="font-weight:bold">' + estadosPedidos[pedido.estado].toUpperCase() + '</span></div>'
    html += '<div class="col-2 contenedor-boton-borrar"><img class="boton-borrar" src="../media/Img/inf.png"></div>'
    html += '</div>  '
    html += '</div>  '
    html += '</li>'
    return html;

}
</script>