<body class="body-color">


    <div class="container-fluid back-header-listing-adm">

        <div class="row">
            <div class="col-6 paddingn">
                <div class="row">
                    <div class="col-5 paddingr">
                        <img src="media/Img/jobs_one.png" />
                    </div>
                    <div class="col-7 paddingl name-perfil-adm text-left">
                        <h6 id="nombreAdmin">Juanelo Gabines</h6>
                        <h5>PROPIETARIO</h5>
                    </div>
                </div>
            </div>
            <div class="col-6">
                <div class="row">
                    <div class="col-6 paddingr">
                        <div class="precio-pedido"><img src="media/Img/pedido-black.png" /><span id="recaudacionDia">$
                                2.830</span></div>
                    </div>

                    <div class="col-6 paddingl">
                        <div class="hora-pedido"><img src="media/Img/usuarios-black.png" /><span
                                id="cantComensalesDia">25 hora 56 al dia</span></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container contenedor-mesas">
        <!-- primera fila de mesas -->
        <div class="row filas-mesas" id="contenedorMesas">

        </div>

    </div>


    <script src="js/clase_mesa.js"></script>
    <script>
        console.log("admin estado.html")

        var delayTraerEstado = 5000;
        var estadoActual = {};
        var mesas;
        var mesasCargadas = 0;
        var docReady = 0;



        let cbMesas = function (e) {
            //	console.log(e)
            mesas = e
            localStorage["mesas_" + nombreDelSitio] = JSON.stringify(e);
            mesasCargadas = 1;
            if (docReady == 1) Mesa.armarGraficoMesas();
        }

        api.traerMesas(cbMesas)


        $(document).ready(function () {
            docReady = 1;
            if (mesasCargadas == 1) Mesa.armarGraficoMesas();
            console.log("doc ready estado admin");
          
         



            //populo cosas:



            $("h6#nombreAdmin").html(usuario.data.nombre_completo)





            //agrego cachos:
       
        


            cargarEstadoAdmin()
        });

        function verMesa(id) {
            //aca la funcion ver mesa es esta
            //en la pantalla de mesas la funcion es otra
            mostrarEstadoMesaAdmin(id)

        }

        function cbEstadoAdmin(e){
            
            estadoActual = e
                    console.log(estadoActual)
                    $("#recaudacionDia").html("$" + estadoActual.facturacionDia);
                    $("#cantComensalesDia").html(estadoActual.cubiertosDelDia);
                    //estados de las mesas
                    //try { m = JSON.parse(localStorage["mesas_" + nombreDelSitio]) } catch (err) { m = localStorage["mesas_" + nombreDelSitio] }
                    //console.log(m)
                    for (var i = 0; i < estadoActual.mesas.length; i++) {

                        $(".mesa." + estadoActual.mesas[i].id_mesa + " img.mesaImg")[0].src = Mesa.urlPNGsMesas + estadoActual.mesas[i].sillas + "/" + Mesa.estadoMesas[estadoActual.mesas[i].estado_mesa] + ".png";

                    }

                    setTimeout(cargarEstadoAdmin, delayTraerEstado)
        }

        function cargarEstadoAdmin() {
            console.log("estado admin")
            //esta funcion se ejecuta cada 5 segundos
            if (mesas == undefined || mesas.length == 0 || isNaN(mesas[0].id_mesa) || mesas[0].id_mesa == undefined) {
                console.log("error..")
                //  return; //si no estan cargadas las mesas, el grafico, esta funcion no anda

            }

           api.estadoAdmin(cbEstadoAdmin)
        }

        cargarEstadoAdmin();
    </script>

</body>

</html>